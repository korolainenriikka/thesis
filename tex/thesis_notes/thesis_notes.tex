\documentclass{article}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{geometry}
\usepackage[style=numeric,bibstyle=numeric,backend=biber,natbib=true,maxbibnames=99,giveninits=true,uniquename=init]{biblatex}
\usepackage[utf8]{inputenc}

\addbibresource{../bibliography.bib}
\title{Thesis notes}

\begin{document}

\tableofcontents

\section{Abstract}

Keywords: Optical character recognition, Few-shot transfer learning, Vision transformers, Paleontological databases

\section{Introduction}

% outline of an introduction
% introduce the broad research area, why this is interesting
% explanation of the specific problem
% brief review of standard solutions to this (or related) problem(s) and their limitation in this case (incl. reference key papers)
% outline of the new solution
% how the solution was evaluated, what were the results of this evaluations

% relevance for other work: why was this specific problem? how can this be concretely used?
relevance of this work: any field that does ocr on unconventional characters, or constrained vocabulary.
direct relevance to museums digitizing fossil data specifically, but could be any old handwriting.

% organization
The rest of this thesis is organized as follows.


\section{Deep Neural Networks for Optical Character Recognition}

% introduction to chapter
% point of this section: present relevant deep learning theory
% running example: reading characters from images (optical character recognition, OCR)

separate problems: character classification (easy, kNN, SVM), reading variable-length text (harder) \cite{ocr_survey}
introduce the problem of ocr, example: fossil catalogue

%miscellaneous keywords to explain (maybe somewhere) from \cite{li2021trocr}
%- knowledge distillation
%- model compression
%- image patches

\subsection{Deep Neural Networks: basics}

- training/validation/test data sets
- neurons and activation functions. maybe examples of activation functions: relu, sigmoid, softmax
- feed forward, backpropagation
- weight initialization

\subsection{Training neural networks}

- learning rate
- batch size

\subsubsection{Loss functions}

Loss function is a function from model predictions and ground truth labels that describes with a single 
scalar value how good the match was, low number describing a good match \cite{princebook}.
These functions are constructed to be equivalent with maximum likelihood solution, think the model would 
output a conditional distribution of outputs, p(y|x).
each ground truth label in the training set should have a high probability in this distribution. Product of all 
these probabilities is called likelihood. Find parameters that maximize the likelihood of the training data set.
Loss functions are derived so that parameters bringing loss to zero is equivalent to the parameters with maximum likelihood.
Derivations are out of scope.

- cross-entropy loss 
kullback-leibler divergence of correct conditional probability and conditional probability parametrized by current model parameters.
(show formula, 5.27), correct is not dependent on parameters so is omitted. show 5.29, what is left from that 
(until here from \cite{princebook})

then: how cross-entropy loss is computed
% from https://machinelearningmastery.com/cross-entropy-for-machine-learning/, find a proper reference
used for classification problems. eg. is this letter in this image an 'a' or a 'b'.
correct probabilities eg .1 and .9 for a or b. model says .2 and .8. discretisized cross entropy computes 
it as .2*log.1+.8*log.9, log in base 2.

- CTC loss

\subsubsection{Evaluating model performance}

- performance metrics
	- precision
	- recall 
	- f1
    - cer (character error rate)

\subsection{Architectures}

\subsubsection{Convolutional layers}

convolution (cross-correlation)
max pooling / average pooling operations

\subsubsection{Transformers}

- self-attention
- multi-head self-attention
- tokenizing and the cls token

\subsubsection{Autoencoders}

- encoder/decoder

\subsection{Techniques and heuristics for improving performance}

miscellaneous points, like

- data augmentation

\subsection{Transfer learning}

basics: what it is 
initialize weights to those that suit a related task, it is assumed that the starting point is already very good
catastrophic forgetting = forgetting the previously learned after finetuning

\subsubsection{Foundation models}

- generalist models
	- large unsupervised training data sets

\section{Fundamentals on paleoecology}

This section will have a summary on what fossil data can be used for.

the why: why do this at all? why is accurate dental data relevant, in general?

\subsection{Basics on ecology}

Nature is highly complicated -> models, approximate laws and assumptions enable drawing conclusions from
known distributions of species. Assumptions hold usually, not always, in reality but need to be in place 
because nothing could be known without them

Tolerances and niches (fundamental + realized): basis for environmental reconstruction \cite{Faith_Lyman_2019} ch 2

Assume that nearest living relative has same tolerances now -> get past environment (ch3)

Presence/absence/abundance: (ch3) species living somewhere -> environment matches the fundamental niche. absent more complicated,
environment may or may not be suitable (eg a fossil sample was simply not found). abundance estimation harder, but more
fine-resolution environmental analysis

transfer function: paleobiotic data -> environment (ch2)

environment is constructed with a coarse resolution such as how many 10cm's of precipitation (ch2)

Theory that the data analysis relies on

\subsection{Paleoenvironmental reconstruction}

purpose of this section: how the data can be used

fundamental idea: you have a list of taxa occurring in a place at certain geological time.
how to map this list to an environment?

presence/absence approach: use information on what species were present, to lesser extent those absent (absence has many reasons so not as reliable)
either fix species or place. fix species: find where this set of species lives now (climate maps \& areas of sympatry), this indicates 
that historical locality had this climate. place-fixing: analyze how which species show up in this place
 changes over time, reduce species showing up data to lower dimension
(like pca), eg how many warm-climate vs cold-climate species show up, this gives ideas on changes in climate over time.

\subsection{Diets and evolution}

maybe, how the data is used

\subsection{Composition of mammal teeth}

Fossils occur when animal / plant remains are deposited in a sediment in a way that preserves 
some part of its original form. Since teeth are the hardest material in animals, large fraction
of found parts are teeth. Fossil finding is followed by identification to most specific taxon possible
largely a technical skill (ch5), teeth are identified down to type and number, how manyeth the teeth are,
counting from center to edge or other way round??
specimen can be either one tooth or fragments of the jaw bone where there are multiple teeth (markings like M1-3)

from \cite{Hillson_2005} what teeth are composed of

 the jaw bones
lower jaw bones: mandibles
 permanent and deciduous (D), nonpermanent "milk" teeth (laita vaan jos löytyy d-hampaita)

right and left sides are always symmetrical, denoted simply L or R or Lt or Rt or left or right. left is left looking from the animal, not the observers perspective
Identicality also causes that sometimes tooth fossils are misidentified to the wrong side and corrected (ei lähteestä vaan nähty datasta koska l ja r on sutattu aika monta kertaa ja vaihettu

four classes, front to back: three incisors (I), one canine (C), four premolars (P), three molars (M). top bottom left right. top/bottom noting upper jaw as superscript lower jaw as lower script, 
 purpose: incisor -> catching, canine -> stabbing / killing prey, molars are for chewing. premolars are bit like canines bit like molars, function varies lot
 between taxa including holding, cutting and chewing. also form and number of each present changes between taxa.
sometimes lower jaw as line on top and upper jaw as line on bottom, sometimes both are used: upper script number with line on bottom. Line is "the other jaw"
if there are less of a type of teeth eg two premolars, they might be no 1 and 2 or no 3 and 4

 hillson image on mammal teeth

% summary of chapter

\section{Experimental setup}

% introduction to chapter

\subsection{data description}

has been done by different annotators, no logs on who logged what, everyone 
had a bit different style of notating. also no clearly defined standard 
for notating specimens. so might be that actual data used will have 
characters or words not present in any data, causing errors.


Identicality also causes that sometimes tooth fossils are misidentified to 
the wrong side, seen in data with smudged over l's and r's

Catalogues have lines between entries. challenge for the model to not mark these as underlined
in these cases the line is long and spans the entire image, so it should be distinguishable from 
a single underlined character.

\subsubsection{Notes on creating the dataset}

Hand-labeled

Data was extracted from scans by getting bounding boxes from Azure Vision API,
finding the correct column (nature of specimen or element), and cropping the image 
according to bounding boxes.

Non-tooth samples were not discarded since they contain 
bone fossil related words and good samples of the handwriting style of this dataset.

smudged-over "L" was labeled as "R", and other way around: it seems that later 
someone found it was the opposite side after all. Hope of this is that the model 
would learn to map "messy L" as "R". snudged "left" or "right" was not noted as the 
opposite as there were too few such samples.

Superscript seems much more rare than lower script

Data was labeled not by individual characters but as full tooth descriptions
to preserve context where tooth special characters are more likely to occur

Some have been corrected by writing on top and thus are very hard 
even for humans to read, this is also an example of smudged-over correction: 

\includegraphics*[scale=0.2]{../images/superambiguous_data_sample.png}

\subsubsection{Unicode characters used for data labeling}

explain: unicode has graphenes with code points. eg a is one graphene one code point,
à is one graphene two code points (dot on top and the letter). the top thing -like characters will be called 
"modifiers".

markings contain letters and numbers with no line, line on top or line at the bottom.
Each character can be lower- or upper script. The modifiers used are: 
macron with lower ($\bar{\mathrm{A}}$) and upper variant.

Unicode \cite{unicode_homepage} has characters that are for example upper script, but 
these were not used for two reasons:

- lower and upper script character set is incomplete for this purpose (eg 3 with upper macron and lower script needed)

- from the model perspective 3 and $_3$ are no more similar than A and B, however, 
three combined with lower script modifier and 3 with upper script modifier 
all contain the same unicode character 3 with only the modifier changing. The 
problem here is that there is no lower or upper case modifiers in unicode. Therefore,
the caron ($\check{\mathrm{A}}$) was chosen as the lower script modifier, and the circumflex accent ($\hat{\mathrm{A}}$)
as upper script. These were chosen since the arrow-like modifier pointing up or down
is maybe the most logical placeholder for the missing modifier. More traditional 
workarounds of missing upper or lower script, the underscore "\_" and separate 
caret character "\^ " were not used to keep one unicode graphene represent one character 
on the page. Also on the other hand using one modifier for all lowercase characters allows 
the model to understand that there is a similarity between all lowercase characters.
The intention is that one idea about a character is encoded as one code point, so that 
the model can learn the mapping from the image of the character to the code point 
combination
(until now already in thesis text)
----

also: some annotators used / instead of line. left to / -> upper, right -> lower.
annotate with up/down macron

\subsection{Data preprocessing}

Convert to black and white since text reading should not change when color of writing / background changes?

Convert to background completely white, foreground completely black? Either there is a line or not?

\subsection{Methods: base models and transfer learning tehniques}

\subsubsection{Encoding prior knowledge}
Priors. base model already knows the output should be a word, eg "jdaslkjflkds" is a highly unlikely
correct answer.
Bone notation has a very small subset of possible english words, eg. the word "beach ball" cannot ever be a correct 
answer for a reading

% summary of chapter

\section{Results and discussion}

% introduction to chapter

% summary of chapter

\section{Conclusions}

\printbibliography

\end{document}